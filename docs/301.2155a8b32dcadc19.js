"use strict";(self.webpackChunkClient=self.webpackChunkClient||[]).push([[301],{7301:(W,O,l)=>{l.r(O),l.d(O,{CollectionsModule:()=>C});var a=l(6895),r=l(8084),M=l(9948),h=l(590),t=l(4650),b=l(8505),P=l(2340),L=l(529);class d{constructor(o){this.httpClient=o,this.offset=0,this.limit=100}resetPagination(){this.offset=0,this.limit=100}getCollections(o){let e=`offset=${this.offset}&limit=${this.limit}`;return o&&(e+=`&title=${o}`),this.httpClient.get(`${P.N.apiUrl}/collections/search?${e}`).pipe((0,b.b)(()=>this.offset+=this.limit))}getCollection(o){return this.httpClient.get(`${P.N.apiUrl}/collections/${o}`)}static#t=this.\u0275fac=function(e){return new(e||d)(t.LFG(L.eN))};static#o=this.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}var f=l(6457),v=l(3618),_=l(6667),y=l(5224),x=l(3156),T=l(2890);function w(s,o){if(1&s&&(t.ynx(0),t._UZ(1,"app-photo-card",8),t.BQk()),2&s){const e=o.$implicit;t.xp6(1),t.Q6J("photo",e)}}function I(s,o){if(1&s&&(t.TgZ(0,"div"),t.YNc(1,w,2,1,"ng-container",7),t.qZA()),2&s){const e=o.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}class g{constructor(o,e,n,i){this.activatedRoute=o,this.router=e,this.collectionsService=n,this.photosService=i,this.title="",this.id="",this.indexOfLastLoadedPhoto=0,this.maxNumberOfDisplayedPhotosPerLoad=30,this.numberOfColumnsToDisplay=3,this.displayedPhotosRatio=Array.from({length:this.numberOfColumnsToDisplay},()=>0),this.displayedPhotos=[],this.photos=[],this.getIdFromUrl(),this.initializeColumns()}updateDisplayedPhotos(){this.updatePhotoColumns(),this.photos.length<this.indexOfLastLoadedPhoto+this.maxNumberOfDisplayedPhotosPerLoad?this.indexOfLastLoadedPhoto=this.photos.length:this.indexOfLastLoadedPhoto+=this.maxNumberOfDisplayedPhotosPerLoad}getIdFromUrl(){this.activatedRoute.paramMap.pipe((0,h.P)()).subscribe(o=>{this.id=o.get("id")??"",this.getCollection()})}onOpenedDetails(o){this.router.navigateByUrl(`${this.router.url}/${o.photoId}`)}onClickedBackButton(){this.router.navigateByUrl(this.getCollectionsOverviewPath())}getCollectionsOverviewPath(){let o=this.router.url.lastIndexOf("/");return o=-1==o?this.router.url.length:o,this.router.url.substring(0,o)}initializeColumns(){for(let o=0;o<this.numberOfColumnsToDisplay;o++)this.displayedPhotos.push([])}updatePhotoColumns(){if(this.indexOfLastLoadedPhoto<this.photos.length)for(let o=0;o<this.photos.length;o++){let e=this.getColumnNumber();this.displayedPhotos[e].push(this.photos[o]),this.displayedPhotosRatio[e]+=this.photos[o].photoHeight/this.photos[o].photoWidth}}getColumnNumber(){return this.displayedPhotosRatio.reduce((o,e,n,i)=>e<i[o]?n:o,0)}getCollection(){this.collectionsService.getCollection(this.id).pipe((0,h.P)()).subscribe(o=>{this.title=o.collectionTitle,this.getCollectionPhotos(o.photoIds)})}getCollectionPhotos(o){this.photosService.getPhotosById(o).pipe((0,h.P)()).subscribe(e=>{this.photos=e,this.updateDisplayedPhotos()})}static#t=this.\u0275fac=function(e){return new(e||g)(t.Y36(r.gz),t.Y36(r.F0),t.Y36(d),t.Y36(f.V))};static#o=this.\u0275cmp=t.Xpm({type:g,selectors:[["app-collection"]],decls:9,vars:3,consts:[[1,"collections-container"],[1,"top-container"],[1,"hidden-search-bard"],[1,"bottom-container"],[1,"collections-overview-container"],[3,"title","displayBackButton","clickedBackButton"],["scrollWatch","",1,"collections-content",3,"scrollReachedLowerBound"],[4,"ngFor","ngForOf"],[3,"photo"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"app-search-bar",2),t.qZA(),t.TgZ(3,"div",3)(4,"div",4)(5,"app-panel-header",5),t.NdJ("clickedBackButton",function(){return n.onClickedBackButton()}),t.qZA(),t.TgZ(6,"div",6),t.NdJ("scrollReachedLowerBound",function(){return n.updateDisplayedPhotos()}),t.YNc(7,I,2,1,"div",7),t.qZA(),t._UZ(8,"app-panel-footer"),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("title",n.title)("displayBackButton",!0),t.xp6(2),t.Q6J("ngForOf",n.displayedPhotos))},dependencies:[a.sg,v.N,_.e,y.v,x.A,T.l],styles:["[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]{height:88vh}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .top-container[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .top-container[_ngcontent-%COMP%]   .hidden-search-bard[_ngcontent-%COMP%]     .mat-mdc-form-field{visibility:hidden}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]{height:88%;width:71.4%;min-width:1269.5px;display:flex;margin:auto}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]   .collections-overview-container[_ngcontent-%COMP%]{width:100%;background-color:#fff;border-radius:16px}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]   .collections-overview-container[_ngcontent-%COMP%]   .collection-list[_ngcontent-%COMP%]{margin-left:6px}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]   .collections-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex:6;gap:10px 10px;height:88%;padding:16px;overflow:auto}@media screen and (max-width: 507px){[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 1336px){[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]{min-width:200px}}"]})}var B=l(6081),S=l(3546);const D=function(s){return{"z-index":s}},N=function(s,o){return{top:s,margin:"0","box-shadow":"0px 3px 5px 2px rgba(0, 0, 0, 1)",opacity:o}},k=function(s,o){return{"single-photo":s,no_shuffle_image:o}},Z=function(s){return{height:s}};function F(s,o){if(1&s){const e=t.EpF();t.TgZ(0,"div",2),t._UZ(1,"img",3),t.TgZ(2,"div",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onClickImage())}),t.TgZ(3,"p"),t._uU(4),t.qZA()()()}if(2&s){const e=o.$implicit,n=o.index,i=t.oxw();t.Q6J("ngStyle",t.VKq(6,D,i.photos.length-n)),t.xp6(1),t.Q6J("src",e.photoImageUrl,t.LSH)("ngStyle",t.WLB(8,N,8*n+"px",0==n?1:.5)),t.xp6(1),t.Q6J("ngClass",t.WLB(11,k,1===i.photos.length,!i.shuffleOnClick))("ngStyle",t.VKq(14,Z,i.maxImageDimension.height+8*i.photos.length+"px")),t.xp6(2),t.Oqu(i.collection.collectionTitle)}}const A=function(s,o){return{width:s,height:o,overflow:"hidden"}};class m{constructor(o,e){this.photosService=o,this.router=e,this.shuffleOnClick=!0,this.photos=[],this.maxImageDimension={width:0,height:0},this.sortedPhotos=[]}ngAfterViewInit(){this.photosService.getPhotosById(this.collection.photoIds).pipe((0,h.P)()).subscribe(o=>{this.photos=o.slice(0,10),o.forEach(e=>{e.photoImageUrl=e.photoImageUrl+"?w=300",this.find(e)})})}find(o){const e=new Image;e.src=o.photoImageUrl,e.onload=()=>{this.sortedPhotos.push([e.height,o]),this.maxImageDimension={width:Math.max(e.width,this.maxImageDimension.width),height:Math.max(e.height,this.maxImageDimension.height)},this.sortedPhotos.length===this.photos.length&&(this.sortedPhotos.sort((n,i)=>n[0]-i[0]),this.photos=this.sortedPhotos.map(n=>n[1]))}}shiftArrayToRight(o,e){for(var n=0;n<e;n++)o.unshift(o.pop())}shiftArrayToLeft(o,e){for(var n=0;n<e;n++)o.push(o.shift())}onClickImage(){this.shuffleOnClick&&this.photos.length>1?this.shiftArrayToLeft(this.photos,1):this.router.navigateByUrl(`${this.router.url}/${this.collection.collectionId}`)}static#t=this.\u0275fac=function(e){return new(e||m)(t.Y36(f.V),t.Y36(r.F0))};static#o=this.\u0275cmp=t.Xpm({type:m,selectors:[["app-photo-stack"]],inputs:{collection:"collection",shuffleOnClick:"shuffleOnClick"},decls:2,vars:5,consts:[[1,"photo-stack",3,"ngStyle"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["mat-card-image","",1,"image__img",3,"src","ngStyle"],[1,"image__overlay","image__overlay--primary",3,"ngClass","ngStyle","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,F,5,16,"div",1),t.qZA()),2&e&&(t.Q6J("ngStyle",t.WLB(2,A,n.maxImageDimension.width+"px",n.maxImageDimension.height+8*n.photos.length+"px")),t.xp6(1),t.Q6J("ngForOf",n.photos))},dependencies:[a.mk,a.sg,a.PC,S.G2],styles:[".photo-stack[_ngcontent-%COMP%]{margin-top:16px}img[_ngcontent-%COMP%]{position:absolute;margin:10px;transition:transform .3s ease-in-out}div[_ngcontent-%COMP%]{position:relative}.image[_ngcontent-%COMP%]{position:relative;width:400px;margin-top:6px}img[_ngcontent-%COMP%]{border-bottom-left-radius:16px;border-bottom-right-radius:16px}.image__img[_ngcontent-%COMP%]{display:block;width:100%}.image__overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;background:rgba(0,0,0,.6);color:#fff;font-family:Quicksand,sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:0;transition:opacity .25s}.image__overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:80%;text-align:center;font-size:24px;line-height:30px}.image__overlay--blur[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.image__overlay--primary[_ngcontent-%COMP%]{background:#3b3939}.image__overlay[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{transform:translateY(20px);transition:transform .25s}.single-photo.image__overlay[_ngcontent-%COMP%]:hover{opacity:.6;transition-delay:0s;cursor:pointer}.image__overlay[_ngcontent-%COMP%]:hover{opacity:.6;transition-delay:2s;cursor:pointer}.no_shuffle_image.image__overlay[_ngcontent-%COMP%]:hover{transition-delay:0s}.image__overlay[_ngcontent-%COMP%]:hover > *[_ngcontent-%COMP%]{transform:translateY(0)}.image__description[_ngcontent-%COMP%]{font-size:1.5em;margin-top:.25em}@media screen and (max-width: 507px){.image__overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px}}"]})}function J(s,o){if(1&s&&(t.ynx(0),t._UZ(1,"app-photo-stack",10),t.BQk()),2&s){const e=o.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("collection",e)("shuffleOnClick",n.shuffleOnClick)}}function U(s,o){if(1&s&&(t.TgZ(0,"div",8),t.YNc(1,J,2,2,"ng-container",9),t.qZA()),2&s){const e=o.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}class p{constructor(o,e,n,i){this.collectionsService=o,this.photosService=e,this.router=n,this.loaderService=i,this.title="Collections",this.numberOfColumnsToDisplay=3,this.indexOfLastLoadedCollection=0,this.maxNumberOfDisplayedCollectionsPerLoad=30,this.searchOptions={},this.lastScrolledPosition=0,this.shuffleOnClick=!0,this.collections=[],this.displayedCollections=[],this.isLoading=!1}ngOnInit(){this.collectionsService.resetPagination(),this.initializeColumns(),this.getCollections()}onToggleChange(o){this.shuffleOnClick=o}onSearchTermChange(o){this.searchOptions=o,this.clearCollections(),this.getCollections()}onOpenedDetails(o){this.router.navigateByUrl(`${this.router.url}/${o.collectionId}`)}updateDisplayedCollections(){this.getCollectionsToDisplayForCurrentPage()}clearCollections(){this.collectionsService.resetPagination(),this.displayedCollections=[],this.collections=[],this.initializeColumns(),this.indexOfLastLoadedCollection=0,this.maxNumberOfDisplayedCollectionsPerLoad=30}initializeColumns(){for(let o=0;o<this.numberOfColumnsToDisplay;o++)this.displayedCollections.push([])}getCollections(){this.collectionsService.getCollections(this.searchOptions.term).pipe((0,h.P)()).subscribe(o=>{this.collections.push(...o),this.updateCollectionsThumbnail()})}updateCollectionsThumbnail(){const o=this.collections.map(e=>e.photoIds[0]);this.photosService.getPhotosById(o).pipe((0,h.P)()).subscribe(e=>{e.forEach(n=>{const i=this.collections.findIndex(c=>n.photoId===c.photoIds[0]);this.collections[i].photoThumbnailUrl=n.photoImageUrl}),this.updateDisplayedCollections()})}getCollectionsToDisplayForCurrentPage(){this.updateCollectionsColumns(),this.collections.length<this.indexOfLastLoadedCollection+this.maxNumberOfDisplayedCollectionsPerLoad?this.indexOfLastLoadedCollection=this.collections.length:(this.indexOfLastLoadedCollection+=this.maxNumberOfDisplayedCollectionsPerLoad,this.shouldRetrieveMoreCollections()&&this.getCollections())}updateCollectionsColumns(){for(let o=0;o<this.numberOfColumnsToDisplay;o++)this.updateColumn(o)}updateColumn(o){let e=[];const i=this.indexOfLastLoadedCollection+this.maxNumberOfDisplayedCollectionsPerLoad;for(let c=this.indexOfLastLoadedCollection+o;c<i;c+=this.numberOfColumnsToDisplay)e.push(this.collections[c]);this.displayedCollections[o].push(...e)}shouldRetrieveMoreCollections(){return this.collections.length-this.indexOfLastLoadedCollection<this.maxNumberOfDisplayedCollectionsPerLoad}static#t=this.\u0275fac=function(e){return new(e||p)(t.Y36(d),t.Y36(f.V),t.Y36(r.F0),t.Y36(B.LA))};static#o=this.\u0275cmp=t.Xpm({type:p,selectors:[["app-collections-overview"]],decls:9,vars:3,consts:[[1,"collections-container"],[1,"top-container"],[3,"searchTermChange"],[1,"bottom-container"],[1,"collections-overview-container"],[3,"title","isCollectionMenu","toggled"],["scrollWatch","",1,"collections-content",3,"scrollReachedLowerBound"],["class","collection-list",4,"ngFor","ngForOf"],[1,"collection-list"],[4,"ngFor","ngForOf"],[3,"collection","shuffleOnClick"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-search-bar",2),t.NdJ("searchTermChange",function(c){return n.onSearchTermChange(c)}),t.qZA()(),t.TgZ(3,"div",3)(4,"div",4)(5,"app-panel-header",5),t.NdJ("toggled",function(c){return n.onToggleChange(c)}),t.qZA(),t.TgZ(6,"div",6),t.NdJ("scrollReachedLowerBound",function(){return n.updateDisplayedCollections()}),t.YNc(7,U,2,1,"div",7),t.qZA(),t._UZ(8,"app-panel-footer"),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("title",n.title)("isCollectionMenu",!0),t.xp6(2),t.Q6J("ngForOf",n.displayedCollections))},dependencies:[a.sg,v.N,_.e,y.v,x.A,m],styles:["[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]{height:88vh}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .top-container[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]{height:88%;width:71.4%;display:flex;margin:auto}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]   .collections-overview-container[_ngcontent-%COMP%]{width:100%;background-color:#fff;border-radius:16px}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]   .collections-overview-container[_ngcontent-%COMP%]   .collection-list[_ngcontent-%COMP%]{margin-left:6px}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]   .collections-content[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;flex:6;gap:10px 10px;height:88%;padding:16px;overflow:auto}@media screen and (max-width: 507px){[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .collections-container[_ngcontent-%COMP%]   .bottom-container[_ngcontent-%COMP%]{width:100%}}"]})}const z=[{path:"",component:p},{path:":id",component:g},{path:":collectionId/:photoId",component:M.g},{path:"**",component:p}];class u{static#t=this.\u0275fac=function(e){return new(e||u)};static#o=this.\u0275mod=t.oAB({type:u});static#e=this.\u0275inj=t.cJS({imports:[r.Bz.forChild(z),r.Bz]})}var Y=l(4655),$=l(4805),Q=l(294),R=l(1695);class C{static#t=this.\u0275fac=function(e){return new(e||C)};static#o=this.\u0275mod=t.oAB({type:C});static#e=this.\u0275inj=t.cJS({imports:[a.ez,u,Y.m,$.x,Q.I,R.PhotosModule]})}}}]);